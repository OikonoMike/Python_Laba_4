# Лабораторная работа №4.
## Симуляция с пользовательсĸими ĸоллеĸциями и псевдослучайной моделью

---

## Архитектура работы
```
Python_Laba_4/
├── src/
│   ├── __init__.py
│   ├── book.py          
│   ├── collections.py   
│   ├── Library.py       
│   └── simulation.py    
├── tests/
│   ├── __init__.py
│   ├── test_book.py          
│   ├── test_collections.py   
│   ├── test_library.py       
│   └── test_simulation.py
├── README.md
├── requirements.txt
├── pyproject.toml
├── .gitignore
└── .pre-commit-config.yaml
```
---

## Реализованные компоненты
1. **Классы предметной области**
- `Book` — базовый класс книги с полями: `title`, `author`, `year`, `genre`, `isbn`, `age_rating`.
- `PhysicalBook` — физическая книга с ограниченным числом копий, поддерживает `borrow()` и `return_copy()`.
- `DigitalBook` — электронная книга, всегда доступна, но требует устройство для чтения.


2. **Пользовательские коллекции**\
- `BookCollection` — списковая коллекция с поддержкой:
  - `__getitem__` (включая срезы),
  - `__iter__`, `__len__`,
  - методов `append_book()`, `remove_book()`.
- `IndexDict` — словарная коллекция с индексацией по:
  - **ISBN** (основной ключ),
  - **автору** → список книг автора,
  - **году издания** → список книг этого года.
- При добавлении/удалении книги — все индексы обновляются автоматически.


3. **Библиотека (Library)**
- Хранит `BookCollection` и `IndexDict`.
- Методы:
  - `add_book(book)`
  - `remove_book(isbn)`
  - `find_by_isbn(isbn)`
  - `find_by_author(author)`
  - `find_by_year(year)`


4. **Симуляция (`run_simulation`)**
- Поддерживает 6 типов событий:
  - Добавление случайной книги,
  - Удаление случайной книги,
  - Поиск по автору,
  - Поиск по году,
  - Попытка найти несуществующую книгу (обработка `KeyError`),
  - Взятие физической книги (с проверкой доступности).
- Использует `random.seed()` для воспроизводимости.
- Каждый шаг логируется, даже если действие невозможно (например, «библиотека пуста»).

### Обрабатываемые ошибки
- `ValueError`: при создании `PhysicalBook` с отрицательным числом копий или при попытке взять недоступную книгу.\
- `KeyError`: при попытке найти или удалить несуществующую книгу по **ISBN**.

---

## Установка и запуск
```
git clone https://github.com/OikonoMike/Python_Laba_4
cd Python_Laba_4
```

### Запуск симуляции
Симуляция выполняет 10 случайных событий (добавление, удаление, поиск и т.д.) и выводит лог в консоль:
```bash
python -m src.simulation
```

### Запуск тестов
Все компоненты покрыты тестами на pytest:
```bash
pytest -v
```
Тесты проверяют:
- Корректность работы коллекций (BookCollection, IndexDict)
- Поведение книг (PhysicalBook, DigitalBook)
- Обработку ошибок
- Взаимодействие с библиотекой

